# Projects & Expenses Tracker — Backend

This is the backend service for the take-home assignment.

The goal was to build a simple internal tool where projects can be created, expenses can be tracked against each project, and remaining budget can be calculated automatically.

I focused on keeping the architecture clean and easy to understand rather than over-engineering it.

---

## Tech Stack

* Node.js
* Express.js
* PostgreSQL
* pg (node-postgres)

---

## How to Run Locally

### 1. Clone the repo

```bash
git clone <repo-link>
cd kea-tracker-server
```

---

### 2. Install dependencies

```bash
npm install
```

---

### 3. Create `.env` file

Add the following:

```env
PORT=5000

DB_USER=postgres
DB_HOST=localhost
DB_NAME=kea_tracker
DB_PASSWORD=your_password
DB_PORT=5432
```

---

### 4. Setup database

Create a database named:

```
kea_tracker
```

Then run the table scripts below.

---

## Database Schema

### Projects Table

```sql
CREATE TABLE projects (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  client_name VARCHAR(255) NOT NULL,
  estimated_budget NUMERIC(12,2) NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

### Expenses Table

```sql
CREATE TABLE expenses (
  id SERIAL PRIMARY KEY,
  project_id INTEGER REFERENCES projects(id) ON DELETE CASCADE,
  description TEXT NOT NULL,
  amount NUMERIC(12,2) NOT NULL,
  category VARCHAR(50)
    CHECK (category IN ('material','labor','other')),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

Relationship:

* One project → many expenses
* Deleting a project deletes its expenses automatically (cascade)

---

## Running the server

```bash
npm start
```

Server runs on:

```
http://localhost:5000
```

---

## API Endpoints

### Projects

**Create project**

```
POST /api/projects
```

**Get all projects (with budget summary)**

```
GET /api/projects
```

This returns:

* Estimated budget
* Total expenses
* Remaining budget

---

**Get single project + expenses**

```
GET /api/projects/:id
```

---

**Update project**

```
PUT /api/projects/:id
```

---

**Delete project**

```
DELETE /api/projects/:id
```

---

### Expenses

**Add expense**

```
POST /api/expenses
```

---

**Update expense**

```
PUT /api/expenses/:id
```

---

**Delete expense**

```
DELETE /api/expenses/:id
```

---

## Budget Calculation Logic

Budget summary is calculated at query level using SQL aggregation:

* SUM of all expenses per project
* Remaining = estimated budget − total expenses

Handled using `LEFT JOIN` + `COALESCE` so projects with no expenses still show correct values.

---

## Assumptions

* No authentication required (as per assignment scope)
* All users can create and manage projects
* Budget stored as numeric with 2 decimal precision
* Expense categories are limited to material, labor, other

---

## What I’d Improve With More Time

If this were a production tool, I’d add:

* Authentication & user roles
* Expense file uploads (invoices)
* Budget overspend alerts
* Filtering & pagination
* Validation middleware
* Unit tests

---

That’s it — kept the backend simple, readable, and aligned with the assignment requirements.
